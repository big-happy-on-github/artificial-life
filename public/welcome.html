<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIAMLAND</title>
    <link rel="stylesheet" href="css/styles.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9556203064620862"
     crossorigin="anonymous"></script>
    <meta name="google-adsense-account" content="ca-pub-9556203064620862">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>
    <header>
        <a href="/welcome"><h1>LIAMLAND</h1></a>
        <div id="menu">
            <a href="/updates"><p>updates</p></a>
            <a href="/about"><p>about me</p></a>
            <a href="/faq"><p>FAQ</p></a>
        </div>
        <div class="feedback-container">
            <label for="feedbackInput">got feedback?: </label>
            <input id="feedbackInput">
            <button onclick="addData(document.getElementById('feedbackInput').value)">send</button>
        </div>
    </header>
    <div id="limbucks">10 limbucks</div>
    <main>
        <div>
            <img src="img/wheel.png" width="400" height="375">
            <p id="wheelP">Daily Wheel</p>
            <button onclick="window.location.href='/projects/wheel'" id="wheelButton">play</button>
        </div>
        <div>
            <img src="img/liamstd.png" width="400" height="375">
            <p id="liamstdP">LiamsTD</p>
            <button onclick="window.location.href='/projects/liamstd'" id="liamstdButton">play</button>
        </div>
        <div>
            <img src="img/chat.png" width="400" height="375">
            <p id="chatP">Liam's Chat</p>
            <button onclick="window.location.href='/projects/chat'" id="chatButton">play</button>
        </div>
    </main>
    <script type="module" src="/js/liamland.js"></script>
    <script type="module">
        // Initialize Supabase client
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
        
        const supabaseUrl = 'https://kjfnxynntottdbxjcree.supabase.co'; // Replace with your Supabase project URL
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtqZm54eW5udG90dGRieGpjcmVlIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcyODE2MTYzMiwiZXhwIjoyMDQzNzM3NjMyfQ.NLNoMifNOv4seeTLCCV_ZiUmR-YGS7MJnm1bUqZ2B8g'; // Replace with your Supabase API key
        const supabase = createClient(supabaseUrl, supabaseKey);

        // Check if there is a row with project_name 'liamstd'
        const { data, error: selectError } = await supabase
            .from('visits')
            .select('*')
            .eq('project_name', 'liamstd');
        
        // Handle any select errors
        if (selectError) {
            throw selectError;
        }

        console.log(data);

        document.getElementById("liamstdP").textContent += ` (${data[0].num_visits} visits)`;
    </script>
    <script type="module">
        // Initialize Supabase client
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
        
        const supabaseUrl = 'https://kjfnxynntottdbxjcree.supabase.co'; // Replace with your Supabase project URL
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtqZm54eW5udG90dGRieGpjcmVlIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcyODE2MTYzMiwiZXhwIjoyMDQzNzM3NjMyfQ.NLNoMifNOv4seeTLCCV_ZiUmR-YGS7MJnm1bUqZ2B8g'; // Replace with your Supabase API key
        const supabase = createClient(supabaseUrl, supabaseKey);
        
        const { data, error: selectError } = await supabase
            .from('visits')
            .select('*')
            .eq('project_name', 'chat');

        document.getElementById("chatP").textContent += ` (${data[0].num_visits} visits)`;
    </script>
    <script type="module">
        // Initialize Supabase client
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
        
        const supabaseUrl = 'https://kjfnxynntottdbxjcree.supabase.co'; // Replace with your Supabase project URL
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtqZm54eW5udG90dGRieGpjcmVlIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcyODE2MTYzMiwiZXhwIjoyMDQzNzM3NjMyfQ.NLNoMifNOv4seeTLCCV_ZiUmR-YGS7MJnm1bUqZ2B8g'; // Replace with your Supabase API key
        const supabase = createClient(supabaseUrl, supabaseKey);
        
        const { data, error: selectError } = await supabase
            .from('visits')
            .select('*')
            .eq('project_name', 'wheel');

        document.getElementById("wheelP").textContent += ` (${data[0].num_visits} visits)`;
    </script>
    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
    
        const supabaseUrl = 'https://kjfnxynntottdbxjcree.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtqZm54eW5udG90dGRieGpjcmVlIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTcyODE2MTYzMiwiZXhwIjoyMDQzNzM3NjMyfQ.NLNoMifNOv4seeTLCCV_ZiUmR-YGS7MJnm1bUqZ2B8g';
        const supabase = createClient(supabaseUrl, supabaseKey);
    
        const keysPressed = {};
    
        // Function to check the alert status in Supabase
        async function checkAlertInSupabase() {
            const { data, error } = await supabase
                .from('admin')
                .select('info')
                .eq('name', 'alert')
                .single();
    
            if (error) {
                if (error.code == "PGRST116") {
                    return null;
                }
                console.error('Error fetching alert:', error);
                return null;
            }
    
            return data ? data.info : null;
        }
    
        let isAlert = await checkAlertInSupabase();
    
        document.addEventListener('keydown', async function (event) {
            keysPressed[event.key] = true;
    
            if (keysPressed['Control'] && keysPressed['l'] && keysPressed['b']) {
                alert("ooh, so I see you know the command...");
                const password = prompt("...but do you know the password?");
                
                if (password === "HURRICANEHELENE") {
                    alert("ahh, ok");
                    const command = prompt("what would you like to do?");
    
                    if (command.toLowerCase() === "alert") {
                        isAlert = await checkAlertInSupabase();
    
                        if (isAlert) {
                            alert("A past alert must be canceled");
                            if (confirm(`Are you sure you want to cancel "${isAlert}"?`)) {
                                const { error } = await supabase
                                    .from('admin')
                                    .delete()
                                    .eq('name', 'alert');
    
                                if (!error) {
                                    alert('Alert canceled successfully.');
                                    isAlert = null;
                                } else {
                                    alert('Failed to cancel alert.');
                                }
                            }
                        } else {
                            const newAlert = prompt("What should the alert say?");
                            if (newAlert) {
                                const { error } = await supabase
                                    .from('admin')
                                    .insert([{ name: 'alert', info: newAlert }]);
    
                                if (!error) {
                                    alert('New alert set successfully.');
                                    isAlert = newAlert;
                                } else {
                                    alert('Failed to set new alert.');
                                }
                            }
                        }
                    } else if (command.toLowerCase() == "feedback") {
                        const { data, error } = await supabase
                            .from('feedback')
                            .select('feedback')
                        while (true) {
                            if (data) {
                                let feedbackList = [];
                                data.forEach(feedback => {
                                    feedbackList.push(feedback.feedback);
                                });
                                alert(JSON.stringify(feedbackList));
                                break;
                            }
                        }
                    }
                } else {
                    alert("a fake!");
                    const response = await fetch('https://ipinfo.io/json?token=ca3a9249251d12');
                    const ipInfo = await response.json();
                    alert(`You live around ${ipInfo.city}, your IP is ${ipInfo.ip}, and you have ${ipInfo.org}`);
                    alert("womp womp");
                }
            }
        });
    
        document.addEventListener('keyup', function (event) {
            delete keysPressed[event.key];
        });
    
        if (!localStorage.getItem("alert") && isAlert != null || isAlert != localStorage.getItem("alert") != isAlert && isAlert != null) {
            if (localStorage.getItem("alert") != isAlert) {
                alert(isAlert);
                localStorage.setItem("alert", isAlert);
            }
        }
    </script>
</body>
</html>
